<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=mW_CIZvkcW1i7Mw9mVo5Pw1nGhQimsDuvOKTiJCJG5Q);.lst-kix_qld2yj7gp30p-3>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-2>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-4>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-1>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-5>li:before{content:"-  "}ul.lst-kix_8rijj1d2vgn6-8{list-style-type:none}.lst-kix_qld2yj7gp30p-7>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-6>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-8>li:before{content:"-  "}.lst-kix_qld2yj7gp30p-0>li:before{content:"-  "}ul.lst-kix_8rijj1d2vgn6-5{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-4{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-7{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-6{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-1{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-0{list-style-type:none}.lst-kix_8rijj1d2vgn6-7>li:before{content:"-  "}ul.lst-kix_8rijj1d2vgn6-3{list-style-type:none}ul.lst-kix_8rijj1d2vgn6-2{list-style-type:none}ul.lst-kix_qld2yj7gp30p-4{list-style-type:none}.lst-kix_8rijj1d2vgn6-8>li:before{content:"-  "}ul.lst-kix_qld2yj7gp30p-5{list-style-type:none}ul.lst-kix_qld2yj7gp30p-6{list-style-type:none}ul.lst-kix_qld2yj7gp30p-7{list-style-type:none}ul.lst-kix_qld2yj7gp30p-8{list-style-type:none}.lst-kix_8rijj1d2vgn6-6>li:before{content:"-  "}.lst-kix_8rijj1d2vgn6-4>li:before{content:"-  "}.lst-kix_8rijj1d2vgn6-5>li:before{content:"-  "}.lst-kix_8rijj1d2vgn6-3>li:before{content:"-  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_8rijj1d2vgn6-0>li:before{content:"-  "}.lst-kix_8rijj1d2vgn6-1>li:before{content:"-  "}.lst-kix_8rijj1d2vgn6-2>li:before{content:"-  "}ul.lst-kix_qld2yj7gp30p-0{list-style-type:none}ul.lst-kix_qld2yj7gp30p-1{list-style-type:none}ul.lst-kix_qld2yj7gp30p-2{list-style-type:none}ul.lst-kix_qld2yj7gp30p-3{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Ubuntu";font-style:normal}.c7{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c4{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c3{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Ubuntu";font-style:normal}.c6{color:#434343;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Ubuntu";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c8{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c11{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c5{margin-left:36pt;padding-left:0pt}.c12{padding:0;margin:0}.c10{color:inherit;text-decoration:inherit}.c9{font-weight:700}.c1{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Ubuntu"}p{margin:0;color:#000000;font-size:11pt;font-family:"Ubuntu"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:16pt;padding-bottom:6pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-weight:700;font-size:12pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Ubuntu";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c11 doc-content"><h2 class="c4" id="h.j9hm0e44qxfk"><span class="c3">Why you may want to read the article</span></h2><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">I have seen people comparing Cookies and JWT million times. Usually, people claim that Cookies are a stateful authentication mechanism, while JWT is stateless.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>First, this is completely incorrect - </span><span class="c9">Cookies and authentication using Cookies can be stateless</span><span class="c2">, and I will demonstrate this today.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Second, comparing JWT and Cookies is flawed from the start, as they are two entirely different concepts.</span></p><p class="c0 c1"><span class="c2"></span></p><h2 class="c4" id="h.2eqhf38pvqsn"><span class="c3">What is Cookie</span></h2><p class="c0"><span class="c2">In short, cookies are a mechanism for transferring pieces of information between the server and the client over the HTTP protocol, along with other mechanisms such as query parameters, the body, headers, etc.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">However, cookies have some peculiarities that distinguish them from the others.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Traditionally, cookies are initiated by the server in the sense that the server tells the browser which cookie to set, when it should expire, its scope, etc. After this, whenever you make an HTTP request to this server, the browser will send the cookie along. To send the cookie, the browser uses a header called &ldquo;Cookie,&rdquo; which is a special header.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">The flow is the following:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 470.67px;"><img alt="" src="images/image3.png" style="width: 624.00px; height: 470.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c2">1. Browser does not have cookies for this origin (for simplicity assume origin=domain).</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">2. Browser sends request to Server, and the Server replies with Set-Cookie header, which forces browser to set cookie for the domain of the server.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">3. Cookies appear to be saved for this origin (domain), and now will be subsequently sent on each request to the server.</span></p><p class="c0 c1"><span class="c2"></span></p><h2 class="c4" id="h.i4obux3uqsuq"><span class="c3">Stateful authentication</span></h2><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">There are a few methods for saving authentication information so that the user is not prompted to log in again. One of these methods is using a session ID. The flow is as follows</span></p><p class="c0 c1"><span class="c2"></span></p><ul class="c12 lst-kix_qld2yj7gp30p-0 start"><li class="c0 c5 li-bullet-0"><span class="c2">Browser authenticates the user by sending credentials to the server</span></li><li class="c0 c5 li-bullet-0"><span class="c2">The server checks the credentials and saves the authentication information, called sessions, in the database or in memory. It then returns the session ID in the cookies to the browser.</span></li><li class="c0 c5 li-bullet-0"><span class="c2">The browser sends the session ID in the cookies with each subsequent request. The server then checks whether the session ID exists and verifies that the user is authenticated</span></li></ul><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">In this way, the authentication is stateful, as the session &nbsp;is stored on the server, the browser only sends the id of the session. It means that if you kill the server or erase the database - all users will be signed out, however the browser sends the same requests with the same session id.</span></p><p class="c0 c1"><span class="c2"></span></p><h2 class="c4" id="h.rv2k1ubi38uo"><span class="c3">Why Cookie is not stateful</span></h2><p class="c0"><span class="c2">As you can see, if you choose a stateful authentication method, it doesn&#39;t matter whether you use cookies, headers, or the body &mdash; it&rsquo;s still stateful.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">The main point here is that cookies are not an authentication method; they are a way to save and transfer information between the browser/client and the server.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">To make it stateless, stop using session-based authentication. As an alternative, you could still use JWT authentication with cookies. This way, you are using JWT as usual, but instead of localStorage and headers, you&rsquo;re using cookies.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Note: You should still be aware of the peculiarities of cookies, such as the fact that they are per origin (domain). This could cause issues if you&#39;re trying to integrate a React Single Page Application with an authorization server.</span></p><p class="c0 c1"><span class="c2"></span></p><h2 class="c4" id="h.bz73ovb1fcdd"><span class="c3">Demo: JWT with Cookies (stateless cookies auth)</span></h2><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">In this demo we will create a .NET auth server. It will issue JWT and validate JWT via cookies. As a client we are going to use Swagger.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>The full repo with a demo can be found in my </span><span class="c8"><a class="c10" href="https://www.google.com/url?q=https://github.com/andreyka26-git/andreyka26-authorizations/tree/main/SimpleAuth/Cookie.BackendOnly&amp;sa=D&amp;source=editors&amp;ust=1743012722839266&amp;usg=AOvVaw1cBz7Nt0pycyb72n005aNp">Github</a></span><span class="c2">.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">First: create a simple .NET API. It will have 2 endpoints.<br></span></p><h3 class="c7" id="h.e4682r50pql4"><span class="c6">Issue JWT via cookies</span></h3><p class="c0"><span class="c2">For issuing JWT - we are using a standard approach: create claims, get the private key and sign them. Then we return 200 OK with JWT in Cookies.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">```cs</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; [HttpPost(&quot;customcookie/login&quot;)]</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; public async Task&lt;IActionResult&gt; LoginAsync([FromBody] LoginDto req)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var user = await BackendOnly.User.AuthenticateUser(req.UserName, req.Password);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (user == null)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return BadRequest(&quot;Cannot authenticate user&quot;);</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var claims = new List&lt;Claim&gt;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new Claim(ClaimTypes.Name, user.Email),</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new Claim(&quot;FullName&quot;, user.FullName),</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new Claim(ClaimTypes.Role, &quot;Administrator&quot;),</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(Key));</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256);</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var token = new JwtSecurityToken(</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; issuer: JwtIssuer,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; audience: JwtAudience,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; claims: claims,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expires: DateTime.Now.AddHours(1),</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; signingCredentials: credentials</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var tokenString = new JwtSecurityTokenHandler().WriteToken(token);</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Response.Cookies.Append(&quot;myAuthCookie&quot;, tokenString, new CookieOptions</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HttpOnly = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Secure = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SameSite = SameSiteMode.Strict,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Expires = DateTime.Now.AddHours(1)</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Ok();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">```</span></p><p class="c0 c1"><span class="c2"></span></p><h3 class="c7" id="h.pp4drqxb7u5x"><span class="c6">Validate JWT via cookies</span></h3><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">To validate the JWT, we are validating the signature of JWT that we got from Cookies.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">```cs</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; [HttpGet(&quot;auth/validate&quot;)]</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; public IActionResult ValidateToken()</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!Request.Cookies.TryGetValue(&quot;myAuthCookie&quot;, out var tokenString))</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Unauthorized();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var tokenHandler = new JwtSecurityTokenHandler();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var validationParameters = new TokenValidationParameters</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidateIssuer = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidateAudience = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidateLifetime = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidateIssuerSigningKey = true,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidIssuer = JwtIssuer,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValidAudience = JwtAudience,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(Key))</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var principal = tokenHandler.ValidateToken(tokenString, validationParameters, out var validatedToken);</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var claims = principal.Claims.Select(c =&gt; new</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Type = c.Type,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Value = c.Value</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Ok(new</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Message = &quot;Token is valid&quot;,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Claims = claims</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; catch</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return Unauthorized();</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c0"><span class="c2">```</span></p><p class="c0 c1"><span class="c2"></span></p><h3 class="c7" id="h.6xq3t4evz6c0"><span class="c6">Add Swagger for client</span></h3><p class="c0"><span class="c2">Make sure you added Swagger in DI registration:<br></span></p><p class="c0"><span class="c2">```cs</span></p><p class="c0"><span class="c2">builder.Services.AddEndpointsApiExplorer();</span></p><p class="c0"><span class="c2">builder.Services.AddSwaggerGen(o =&gt;</span></p><p class="c0"><span class="c2">{</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; o.SwaggerDoc(&quot;v1&quot;, new OpenApiInfo</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; {</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; Version = &quot;v1&quot;,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; Title = &quot;Auth sample&quot;,</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; Description = &quot;For auth use andreyka26_ as login and Mypass1* as password&quot;</span></p><p class="c0"><span class="c2">&nbsp; &nbsp; });</span></p><p class="c0"><span class="c2">});</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">app.UseSwagger();</span></p><p class="c0"><span class="c2">app.UseSwaggerUI();</span></p><p class="c0"><span class="c2">```</span></p><p class="c0 c1"><span class="c2"></span></p><h3 class="c7" id="h.91dt71fwtw8h"><span class="c6">Demo</span></h3><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>First, we call validate endpoint to make sure we are not authenticated, as we don&rsquo;t have cookies set.<br></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 402.67px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 402.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Then let&rsquo;s authenticate. In my case I&rsquo;m checking 1 hardcoded login+pass pair.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 289.33px;"><img alt="" src="images/image5.png" style="width: 624.00px; height: 289.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">We can see that our cookie was set in the browser.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 284.00px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 284.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Now our validate endpoint will show us claims in the token, that is from Cookie.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 316.00px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 316.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Now, this is a completely stateless approach, as our JWT is self contained, and all servers that know the correct private key - are able to validate it. It means that we can easily scale our servers, respawn or kill them.</span></p></body></html>